model Goal {
  id         String    @id
  userId     String    @map("user_id")
  name       String
  amount     Decimal   @db.Decimal(30, 10)
  currencyId String    @map("currency_id")
  startDate  DateTime  @map("start_date")
  endDate    DateTime? @map("end_date")
  created    DateTime  @default(now())
  modified   DateTime  @updatedAt

  user     User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  currency Currency            @relation(fields: [currencyId], references: [id], onDelete: Restrict)
  accounts GoalLedgerAccount[]

  @@index([userId], name: "goal_userId_idx")
  @@index([startDate], name: "goal_startDate_idx")
  @@index([endDate], name: "goal_endDate_idx")
  @@map("goals")
}

model GoalLedgerAccount {
  id              String   @id @default(uuid(7))
  goalId          String   @map("goal_id")
  ledgerAccountId String   @map("ledger_account_id")
  created         DateTime @default(now())

  goal          Goal          @relation(fields: [goalId], references: [id], onDelete: Cascade)
  ledgerAccount LedgerAccount @relation(fields: [ledgerAccountId], references: [id], onDelete: Cascade)

  @@unique([goalId, ledgerAccountId], name: "goal_ledger_account_unique")
  @@index([goalId], name: "goal_ledger_goalId_idx")
  @@index([ledgerAccountId], name: "goal_ledger_account_idx")
  @@map("goal_ledger_accounts")
}
